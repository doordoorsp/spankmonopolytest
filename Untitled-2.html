<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è™•ç½°å¤§å¯Œç¿</title>
  <style>
    body {
      font-family: "Comic Sans MS", cursive;
      background-color: #fefaff;
      color: #333;
      text-align: center;
    }
    .board {
      display: flex;
      justify-content: center;
      margin: 20px;
      flex-wrap: wrap;
      max-width: 720px;
      margin: auto;
    }
    .tile {
      width: 70px;
      height: 70px;
      margin: 3px;
      background-color: #fff0f6;
      border: 2px solid #ff99cc;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    .player {
      width: 30px;
      height: 30px;
      background-image: url('https://i.imgur.com/hIXs7jy.png');
      background-size: cover;
      margin-top: 5px;
    }
    .controls {
      margin: 20px;
    }
    #log {
      background-color: #fff0fb;
      border: 2px dashed #ff99cc;
      padding: 10px;
      margin: 10px auto;
      max-width: 460px;
      height: 180px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <h1>ğŸ€ è™•ç½°å¤§å¯Œç¿ ğŸ€</h1>
  <div class="board" id="board"></div>
  <div class="controls">
    <button onclick="rollDice()">ğŸ² æ“²éª°å­å›‰</button>
  </div>
  <div id="log"></div>

  <script>
    const boardSize = 50;
    const board = document.getElementById("board");
    const log = document.getElementById("log");
    let playerPos = 0;
    let forcedPose = null;

    const tools = ["æˆ’å°º", "æ‰‹", "è—¤æ¢", "æœ¨æ‹", "çš®å¸¶", "é«®åˆ·", "é£¯å‹º", "æ‹–é‹"];
    const poses = ["ç«™ç«‹", "è¶´åºŠ", "OTK", "è·ªæ’…", "å°¿å¸ƒå§¿", "æ‰‹æ‰¶ç‰†", "æ‰‹æŠ“å°è…¿", "æ‰‹æ‰¶è†è“‹"];

    const specialTiles = [];
    while (specialTiles.length < 10) {
      const r = Math.floor(Math.random() * (boardSize - 2)) + 1;
      if (!specialTiles.includes(r)) specialTiles.push(r);
    }

    const levels = Array.from({length: boardSize}, (_, i) => {
      if (i === boardSize - 1) return "çµ‚é»";
      if (specialTiles.includes(i)) return "ç‰¹åˆ¥";
      if (i % 7 === 0) return "A";
      if (i % 5 === 0) return "B";
      if (i % 3 === 0) return "C";
      return "æ™®é€š";
    });

    const punishmentMap = {
      "A": {name: "é‡åº¦è™•ç½°", min: 80},
      "B": {name: "ä¸­åº¦è™•ç½°", min: 50},
      "C": {name: "è¼•åº¦è™•ç½°", min: 20},
      "ç‰¹åˆ¥": {name: "ç‰¹åˆ¥è™•ç½°", min: 100}
    };

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.pitch = 1.8;
      utter.rate = 1.05;
      utter.voice = speechSynthesis.getVoices().find(v => v.name.includes("Google") && v.name.includes("zh-TW")) || speechSynthesis.getVoices()[0];
      speechSynthesis.speak(utter);
    }

    function renderBoard() {
      board.innerHTML = "";
      for (let i = 0; i < boardSize; i++) {
        const tile = document.createElement("div");
        tile.className = "tile";
        tile.innerHTML = `<div>${levels[i]}</div>`;
        if (i === playerPos) {
          const player = document.createElement("div");
          player.className = "player";
          tile.appendChild(player);
        }
        board.appendChild(tile);
      }
    }

    function logMessage(msg) {
      log.innerHTML = msg + "<br>" + log.innerHTML;
    }

    function getRandom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function rollDice() {
      const roll = Math.floor(Math.random() * 6) + 1;
      playerPos += roll;
      if (playerPos >= boardSize - 1) {
        playerPos = 0;
        speak("å“å‘€ï¼Œå°å£è›‹åˆåˆ°çµ‚é»å•¦ï¼Œé‡ä¾†ä¸€æ¬¡å˜ï½");
        logMessage("ä½ æŠµé”çµ‚é»ï¼Œé‡æ–°å¾èµ·é»é–‹å§‹ï¼");
      } else {
        const level = levels[playerPos];
        const tool = getRandom(tools);
        const pose = forcedPose || getRandom(poses);
        let message = `ä½ æ“²å‡º ${roll} é»ï¼Œä¾†åˆ°æ ¼å­ ${playerPos}ï¼ˆ${level}ï¼‰<br>`;

        if (level === "ç‰¹åˆ¥") {
          const shameOptions = [
            "æ‰‹æŠ±é ­å…‰å±å±ç½°ç«™10åˆ†é˜",
            "æ¥ä¸‹ä¾†éœ€è·ªæ’…å§¿å‹¢é€²è¡ŒéŠæˆ²",
            "é›™æ‰‹é«˜èˆ‰ç½°ç«™5åˆ†é˜",
            "çµ‚é»ä»¥å‰çš†å°¿å¸ƒå§¿æ¥å—è™•ç½°",
            "å”¸å‡ºè‡ªå·±çš„è™•ç½°è¨˜éŒ„, è¨ˆç®—éŒ¯èª¤è™•ç½°å†ä¾†ä¸€å±€",
            "ä¸‹ä¸€å ´è™•ç½°éœ€å£å’¬ä¸Šä¸€å ´çš„å·¥å…·ï¼Œè½ä¸‹éœ€åŠ ç½°è©²å·¥å…·20ä¸‹",
            "æ›ä¸Šç¾æ¥åç‰Œã€éœ€è¦ç®¡æ•™ã€",
            "ä¸‹ä¸€å±€è™•ç½°éœ€å ±æ•¸ï¼Œä¸¦èªªå‡ºã€è¬è¬ï¼Œè«‹ç¹¼çºŒæ‰“æˆ‘çš„å±è‚¡ã€",
            "çµ‚é»ä»¥å‰åªèƒ½ç”¨å¥¶éŸ³èªªè©±, çŠ¯è¦åŠ ç½°20ä¸‹è—¤æ¢ä¸¦å†ä¾†ä¸€å±€",
            "å†ä¾†ä¸€å±€^w^"
          ];
          const selected = getRandom(shameOptions);
          message += `ğŸ’¥ ç‰¹åˆ¥ç¾æ¥è™•ç½°ï¼š${selected}`;
          speak(`å“å‘€ï½ç‰¹åˆ¥è™•ç½°æ™‚é–“åˆ°å›‰ï¼š${selected}`);
          if (selected.includes("è·ªæ’…")) forcedPose = "è·ªæ’…";
          else if (selected.includes("å°¿å¸ƒ")) forcedPose = "å°¿å¸ƒå§¿";
        } else if (punishmentMap[level]) {
          const swats = punishmentMap[level].min + Math.floor(Math.random() * 21);
          message += `ä½¿ç”¨ ${tool}ï¼Œä»¥ ${pose} å§¿å‹¢è™•ç½° ${swats} ä¸‹ï¼ˆ${punishmentMap[level].name}ï¼‰ï¼`;
          speak(`å‘µå‘µï½ä¾†å›‰ï¼Œç”¨ ${tool} æ‰“ä½  ${swats} ä¸‹ï¼Œè¦ä¹–ä¹–ç¶­æŒ ${pose} å§¿å‹¢å–”ï½`);
        } else {
          message += "é€™æ¬¡æ˜¯å®‰å…¨æ ¼ï¼Œé€ƒéä¸€åŠ«å˜ï½";
          speak("å”‰å”·ï¼Œé€™æ¬¡æ”¾éä½ ï½ä½†ä¸‹æ¬¡å°±æ²’é€™éº¼å¹¸é‹å•¦ï½");
        }
        logMessage(message);
      }
      renderBoard();
    }

    renderBoard();
  </script>
</body>
</html>